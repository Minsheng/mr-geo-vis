<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Test City</title>
        <style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>

        <script src="js/three.js" charset="utf-8"></script>
        <script src="js/TrackballControls.js"></script>
        <script src="js/DeviceOrientationControls.js"></script>
        <script src="js/OrbitControls.js"></script>
    </head>
    <body>
        <div id="canvas"></div>

        <script type="text/javascript">
            var container;

            var camera, scene, renderer, controls, element, container;

            var clock = new THREE.Clock();

            init();
            animate();

            function init() {
                scene = new THREE.Scene();
                scene.fog = new THREE.FogExp2( 0xcccccc, 0.002 );

                // set up camera
                // camera = new THREE.PerspectiveCamera(95, 1, 0.001, 700);
                // camera.position.set(100, 100, 100);

                camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 1000 );
                camera.position.z = 500;

                scene.add(camera);

                // world
				var geometry = new THREE.CylinderGeometry( 0, 10, 30, 4, 1 );
				var material =  new THREE.MeshPhongMaterial( { color:0xffffff, shading: THREE.FlatShading } );

				for ( var i = 0; i < 500; i ++ ) {

					var mesh = new THREE.Mesh( geometry, material );
					mesh.position.x = ( Math.random() - 0.5 ) * 1000;
					mesh.position.y = ( Math.random() - 0.5 ) * 1000;
					mesh.position.z = ( Math.random() - 0.5 ) * 1000;
					mesh.updateMatrix();
					mesh.matrixAutoUpdate = false;
					scene.add( mesh );

				}

                // lights

				light = new THREE.DirectionalLight( 0xffffff );
				light.position.set( 1, 1, 1 );
				scene.add( light );

				light = new THREE.DirectionalLight( 0x002288 );
				light.position.set( -1, -1, -1 );
				scene.add( light );

				light = new THREE.AmbientLight( 0x222222 );
				scene.add( light );

                // renderer
                renderer = new THREE.WebGLRenderer( { antialias: false } );
				renderer.setClearColor( scene.fog.color );
				renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( window.innerWidth, window.innerHeight );

                element = renderer.domElement;
                container = document.getElementById('canvas');
                container.appendChild(element);

                // controls for mouse
                controls = new THREE.OrbitControls(camera, element);
                // controls.rotateUp(Math.PI / 4);
                controls.target.set(
                    camera.position.x + 0.1,
                    camera.position.y,
                    camera.position.z
                );
                controls.enableZoom = false;
                controls.enablePan = false;

                function setOrientationControls(e) {
                    if (!e.alpha) {
                        return;
                    }

                    controls = new THREE.DeviceOrientationControls(camera, true);
                    controls.connect();
                    controls.update();
                    window.removeEventListener('deviceorientation', setOrientationControls, true);
                };

                window.addEventListener('deviceorientation', setOrientationControls, true);
            }

            function resize () {
                var width = container.offsetWidth;
                var height = container.offsetHeight;
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
                // effect.setSize(width, height);
            }

            function update (dt) {
                resize();
                controls.update(dt);
            }

            function animate () {
                requestAnimationFrame(animate);
                update(clock.getDelta());
                render();
            }

            function render () {
                renderer.render(scene, camera);
            }
        </script>
    </body>
</html>
